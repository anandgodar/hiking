---
/**
 * Social Pulse Component - PRODUCTION VERSION
 * Removed fake reviews - shows placeholder instead
 */
interface Props {
  userReviews?: {
    enabled: boolean;
    count: number;
    average_rating: number | null;
  };
  mountainName?: string;
}

const { userReviews, mountainName = 'this trail' } = Astro.props;

const hasRealReviews = userReviews?.enabled && userReviews?.count > 0;
---

<div class="space-y-8 mt-12 mb-16">
  <div>
    <h3 class="text-2xl font-bold text-stone-900 font-serif mb-6 flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-stone-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
      </svg>
      Community Reviews
    </h3>

    {hasRealReviews ? (
      <div class="bg-white border border-stone-200 rounded-xl p-6">
        <div class="flex items-center gap-4 mb-4">
          <div class="text-3xl font-bold text-stone-900">
            {userReviews.average_rating?.toFixed(1)}
          </div>
          <div>
            <div class="flex text-yellow-400 text-sm">
              {Array.from({ length: 5 }).map((_, i) => (
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                  fill={i < Math.round(userReviews.average_rating || 0) ? "currentColor" : "none"}
                  stroke="currentColor" stroke-width="2"
                  class={i < Math.round(userReviews.average_rating || 0) ? "text-yellow-400" : "text-stone-200"}>
                  <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                </svg>
              ))}
            </div>
            <div class="text-xs text-stone-500">{userReviews.count} reviews</div>
          </div>
        </div>
      </div>
    ) : (
      <div class="p-8 text-center bg-stone-50 rounded-xl border border-dashed border-stone-200">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 mx-auto text-stone-300 mb-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
        </svg>
        <h4 class="font-bold text-stone-700 mb-2">No Reviews Yet</h4>
        <p class="text-stone-500 text-sm max-w-sm mx-auto">
          Be the first to share your experience hiking {mountainName}!
        </p>
      </div>
    )}
  </div>

  <div class="bg-amber-50 border border-amber-200 rounded-xl p-5">
    <div class="flex items-start gap-3">
      <svg class="w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <div>
        <h4 class="font-bold text-amber-800 text-sm mb-1">Check Current Conditions</h4>
        <p class="text-amber-700 text-sm">
          Trail conditions change frequently. Check recent reports on
          <a href="https://www.alltrails.com" target="_blank" rel="noopener" class="underline hover:text-amber-900">AllTrails</a> or
          <a href="https://www.newenglandtrailconditions.com" target="_blank" rel="noopener" class="underline hover:text-amber-900">NE Trail Conditions</a>
          before your hike.
        </p>
      </div>
    </div>
  </div>
</div>